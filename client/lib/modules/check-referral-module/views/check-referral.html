{% extends "layout.html" %}
{% block extraBody %}
<script src="/modules/check-referral-module/js/check-referral.js"></script>
{% endblock %}
{% block main
%}

<div id="check-referral" class="main-min-height">
    {% raw %}
    <div  id="searchBar" class="top-arrow-container">
        <div class="input-group">
            <span class="input-group-prepend">
                <div class="home-primarySearch-bg input-group-text  border-right-0 height-44">
                    <span style="color: #023047 !important;">
                        <i class="fal fa-search font-23"></i>
                    </span>
                </div>
            </span>
            <input class="height-44 home-primarySearch-bg border-0 form-control py-2" type="search"
                placeholder="Search your resource" id="example-search-input" v-model="viewReferralObj.searchTxt"
                @input="getReferalByCode($event)">
        </div>
        <div class="dropdown d-flex justify-content-end align-items-center ">

            <button class=" custom-select-icon" type="button" id="dropdownMenu2" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false">
                Sort by 
            </button>
            <div class="dropdown-menu no-padding" aria-labelledby="dropdownMenu2">
                <ul class="list-group">
                    <li class="list-group-item list-set-form text-right">Date</li>
                    <li class="list-group-item list-set-form text-right">Hospital</li>
                    <li class="list-group-item list-set-form  text-right">Treatment</li>
                </ul>
            </div>
        </div>
        <div>
            <!-- v-show="getStringLength(viewReferralObj.searchTxt) > 2" -->
            <div v-show="getStringLength(viewReferralObj.searchTxt) > 0" class="recent_content">
                <b>Search result for "{{viewReferralObj.searchTxt}}"</b>
                <div v-for="(refObj, index1) in searchReferrals" class="justify-content-between align-items-center"
                    id="headingTwo">
                    <div class="align-items-center">
                        <div class="collapse_title">
                            <div>
                                <div class="collapse show collapse-container">
                                    <div class="collapse-title">
                                        Date completed
                                    </div>
                                    <div class="collapse-para">
                                        {{changeDateFormat(refObj.updatedAt)}}
                                    </div>
                                    <div class="collapse-title">
                                        Status
                                    </div>
                                    <div class="collapse-para">
                                        Pending
                                    </div>
                                    <div v-show="viewReferralObj.referralType == 'completed'" class="collapse-title">
                                        Code
                                    </div>
                                    <div v-show="viewReferralObj.referralType == 'completed'" class="collapse-para">
                                        {{refObj.reference_code}}
                                    </div>
                                    <div v-show="viewReferralObj.referralType == 'incomplete'"
                                        class="container pr-0 float-btn-cont">
                                        <button class="float-btn" type="button" @click="contineReferral(refObj)">
                                            <i class="fas fa-plus plus-fa-fa" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div v-show="getStringLength(viewReferralObj.searchTxt) > 0 && searchReferrals.length == 0"
            class="recent_content not-found">
            <b>No results found</b>
        </div>
        <div v-if="getStringLength(viewReferralObj.searchTxt) < 1 && viewReferralObj.loginUserFlag=='true'" class='d-flex progress-container'>
            <div @click="fetchReferrals('completed')" class=" col-6 text-center text-complete cursor-pointer"
                v-bind:class="{'text-complete-active':!activeState}">
                Completed
            </div>
            <div @click="fetchReferrals('incomplete')" class="col-6 text-center text-not-complete cursor-pointer"
                v-bind:class="{'text-complete-active':activeState}">
                Not completed
            </div>
        </div>
        <div class="text_blog"  v-show="viewReferralObj.loginUserFlag=='true'" >
            <div class="recent_referrals">
                Recent referrals
            </div>
            <div class="recent_content">
                A list of your most recent referrals
            </div>
            <hr class="dropdown-divider" />
            <div v-for="(referrals, index) in viewReferralArray.slice(0, 1)"
                class="justify-content-between align-items-center" id="headingOne">
                <div class="d-flex pt-2 pb-2 w-100">
                    <div class="flexGrow">
                        {{referrals.date}}
                    </div>
                    <div>
                        <span style="color: #D6D8D8;">
                            <i class="fas fa-chevron-circle-down fa-2x res_fontz arrowClass cursor-pointer"
                                data-toggle="collapse" :href="'#recentCollapseExample1'+ viewReferralObj.referralType" 
                                @click="toggleArrow($event)" role="button" aria-expanded="false"
                                aria-controls="collapseExample"></i>
                        </span>
                    </div>
                </div>

                <!-- <span style="color: #D6D8D8;">
                    <i class="fas fa-chevron-circle-up fa-2x res_fontz arrowClass cursor-pointer"
                        data-toggle="collapse" id="toggle3" data-target="#collapseThree"
                        @click="toggleArrow($event,3,allSectionData)" aria-expanded="true"
                        aria-controls="collapseThree"></i>
                </span> -->
                <div class="collapse show collapse-container" :id="'recentCollapseExample1'+ viewReferralObj.referralType">
                    <div v-for="(refObj, index1) in referrals.data" class="justify-content-between align-items-center"
                        id="headingTwo">
                        <div class="align-items-center">
                            <div class="collapse_title">
                                <div>
                                    <div>
                                        <div v-if="viewReferralObj.referralType == 'completed'" class="collapse-title">
                                            Date completed
                                        </div>
                                        <div v-if="viewReferralObj.referralType == 'incomplete'" class="collapse-title">
                                            Date
                                        </div>
                                        <div class="collapse-para">
                                            {{changeDateFormat(refObj.updatedAt)}}
                                        </div>
                                        <div class="collapse-title">
                                            Status
                                        </div>
                                        <div class="collapse-para">
                                            Pending
                                        </div>
                                        <div v-show="viewReferralObj.referralType == 'completed'"
                                            class="collapse-title">
                                            Code
                                        </div>
                                        <div v-show="viewReferralObj.referralType == 'completed'" class="collapse-para">
                                            {{refObj.reference_code}}
                                        </div>
                                        <div v-show="viewReferralObj.referralType == 'incomplete'"
                                            class="container pr-0 float-btn-cont">
                                            <button class="float-btn" type="button" @click="contineReferral(refObj)">
                                                <i class="fas fa-plus plus-fa-fa" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="text_blog" v-show="viewReferralObj.loginUserFlag=='true'">
            <div class="recent_referrals">
                Past referrals
            </div>
            <div class="recent_content">
                A list of your past referrals
            </div>
            <hr class="dropdown-divider" />
            <div v-for="(referrals, index) in viewReferralArray" v-if="index > 0"
                class="justify-content-between align-items-center" id="headingOne">
                <!-- {{referrals.date}}
                <span style="color: #D6D8D8;">
                    <i class="fas fa-chevron-circle-down fa-2x res_fontz" data-toggle="collapse"
                        :href="'#collapseExample' + index" role="button" aria-expanded="false"
                        aria-controls="collapseExample"></i>
                </span> -->

                <div class="d-flex pt-2 pb-2 w-100">
                    <div class="flexGrow">
                        {{referrals.date}}
                    </div>
                    <div>
                        <span style="color: #D6D8D8;">
                            <i class="fas fa-chevron-circle-down fa-2x res_fontz arrowClass cursor-pointer"
                                data-toggle="collapse" :href="'#collapseExample' + index + viewReferralObj.referralType" id="'collapseExample' + index"
                                @click="toggleArrow($event)" role="button" aria-expanded="false"
                                aria-controls="collapseExample"></i>
                        </span>
                    </div>
                </div>

                <div  class="collapse show collapse-container" :id="'collapseExample' + index + viewReferralObj.referralType">
                <div v-for="(refObj, index1) in referrals.data" class=" justify-content-between align-items-center"
                    id="headingTwo">
                    <div class=" align-items-center">
                        <div class="collapse_title">
                            <div>
                                <div>
                                    <div v-if="viewReferralObj.referralType == 'completed'" class="collapse-title">
                                        Date completed
                                    </div>
                                    <div v-if="viewReferralObj.referralType == 'incomplete'" class="collapse-title">
                                        Date
                                    </div>
                                    <div class="collapse-para">
                                        {{changeDateFormat(refObj.createdAt)}}
                                    </div>
                                    <div class="collapse-title">
                                        Status
                                    </div>
                                    <div class="collapse-para">
                                        Pending
                                    </div>
                                    <div v-show="viewReferralObj.referralType == 'completed'" class="collapse-title">
                                        Code
                                    </div>
                                    <div v-show="viewReferralObj.referralType == 'completed'" class="collapse-para">
                                        {{refObj.reference_code}}
                                    </div>
                                    <div v-show="viewReferralObj.referralType == 'incomplete'"
                                        class="container pr-0 float-btn-cont">
                                        <button class="float-btn" type="button" @click="contineReferral(refObj)">
                                            <i class="fas fa-plus plus-fa-fa" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
        {% endraw %}
    </div>

    {% endblock %}